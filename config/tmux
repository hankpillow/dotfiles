# https://raw.githubusercontent.com/bluz71/dotfiles/master/tmux.conf

#
#  general config

# Change the default prefix.
unbind-key C-b
set -g prefix C-a

# Enable 256 color support.
set -g default-terminal "screen-256color"

# Hack to get clipboard working again on Mac Sierra.
# Read: https://github.com/tmux/tmux/issues/543
if-shell '[[ "$OS" = "Darwin" ]]' \
    'set -g default-command "reattach-to-user-namespace -l ${SHELL}"'

# Needed for CTRL-Left/Right to work.
setw -g xterm-keys on

# Make Vim more responsive.
set -sg escape-time 0

# Increase scroll back limit.
set -g history-limit 3000

# Use vi key bindings in copy mode.
setw -g mode-keys vi

# Window and pane numbering should be 1-based.
set -g base-index 1
setw -g pane-base-index 1

# Renumber windows when one is closed.
set -g renumber-windows on

# Highlight window when it has new activity but don't flash the status line.
setw -g monitor-activity on
set -g visual-activity off

# Enable mouse support including pane focusing and selection support.
set -g mouse on
unbind-key -Tcopy-mode-vi MouseDragEnd1Pane
bind-key -Tcopy-mode-vi MouseDown1Pane send -X clear-selection

#
# Copy and paste
#

# Use Vim style commands for copy and paste. See "Usage, copy and paste" above.
unbind-key [
bind-key space copy-mode
unbind-key p
bind-key p paste-buffer
bind-key -Tcopy-mode-vi v send -X begin-selection
# Copy tmux selection to system clipboard. Different mechanisms are needed for
# Linux and Mac. Allow both Enter and 'y' (for yank) to signify end selection.
if-shell 'case "$OS" in *Linux*) true;; *) false;; esac' \
    'bind-key -Tcopy-mode-vi Enter send -X copy-pipe-and-cancel "xclip -selection primary -i -f | xclip -selection clipboard -i"' \
    'bind-key -Tcopy-mode-vi Enter send -X copy-pipe-and-cancel  "reattach-to-user-namespace pbcopy"'
if-shell 'case "$OS" in *Linux*) true;; *) false;; esac' \
    'bind-key -Tcopy-mode-vi y send -X copy-pipe-and-cancel "xclip -selection primary -i -f | xclip -selection clipboard -i"' \
    'bind-key -Tcopy-mode-vi y send -X copy-pipe-and-cancel  "reattach-to-user-namespace pbcopy"'

#
# Key bindings
#

# Reload tmux.conf via Prefix-r.
bind-key r source-file ~/.tmux.conf \; display "Reloaded ~/.tmux.conf"

# Nicer split window bindings.
unbind-key %
bind-key | split-window -h
unbind-key '"'
bind-key - split-window -v

# Synchronize all panes in the current window.
bind-key y setw synchronize-panes

# Pane resizing.
bind-key -r H resize-pane -L 15
bind-key -r J resize-pane -D 15
bind-key -r K resize-pane -U 15
bind-key -r L resize-pane -R 15

# Move panes around the current window. Use Prefix-q to list pane numbers.
bind-key up swap-pane -D
bind-key down swap-pane -U

# detach client
bind-key d detach
bind-key C-d detach

# Ctrl-Left/Right cycles thru windows (no prefix)
bind-key -n "C-Left"  select-window -t :-
bind-key -n "C-Right" select-window -t :+

# kill current pane/window
bind-key q confirm-before kill-pane
bind-key Q confirm-before kill-window

# # new window
bind-key C-n new-window
bind-key n new-window

#============================
# Style
#============================

# Set the status bar attributes.
set -g status-left-length 40
set -g status-interval 30

# Set status line, windows, pane and message colors.
set -g status-bg colour235
set -g status-fg colour248
setw -g window-status-current-fg colour114
setw -g window-status-current-bg colour235
set -g pane-border-fg colour236
set -g pane-border-bg colour232
set -g pane-active-border-fg colour110
set -g pane-active-border-bg colour232
set -g message-fg colour235
set -g message-bg colour144
set-option -gw window-status-activity-bg colour235
set-option -gw window-status-activity-fg colour216
set-option -gw window-status-activity-attr none

# Set status bar components and style.
set -g status-left "#[bg=colour235]#[fg=colour112]#(id -un) #[bg=colour235]#[fg=colour110]‚ùê #S - "
if-shell 'case "$OS" in *Linux*) true;; *) false;; esac' \
    'set -g status-right "#[bg=colour235]#[fg=colour174]%a %I:%M%P"' \
    'set -g status-right "#[bg=colour235]#[fg=colour174]%a %I:%M%p"' \
